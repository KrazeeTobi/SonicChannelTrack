// JavaScript Document


const progressBar = document.querySelector('.js-loader-progress-bar')
const progressNumber = document.querySelector('.js-loader-progress-number')

const imgLoad = imagesLoaded('body');//body内の画像を監視
const imgTotal = imgLoad.images.length;//画像の総数を取得

let imgLoaded = 0;//ロードした画像カウント
let progressSpeed = 8;//プログレスバーの進むスピード 大きいほど速くなる
let progressCount = 0;//ローディングの進捗状況 0〜100
let progressResult = 0;//ローディングの進捗状況 0〜100



Tween24.parallel(
//Tween24.prop(".js-loader-progress,.loading_logo").opacity(0).y(0),
Tween24.tween(".loading_logo", 1, Ease24._1_SineInOut).opacity(1).delay(0.3).y(0),
	Tween24.tween(".js-loader-progress", 0.5, Ease24._1_SineInOut).opacity(1).delay(0.3).y(0)
	
	 .onComplete(function () {    //complete func

		 
})  
				 
).play();


	//読み込み状況をアップデート
let progressInit = setInterval(function () {
  updateProgress();
}, 25);



//画像を一つロードするたびにimgLoadedのカウントをアップ
imgLoad.on('progress', function (instance, image) {
  imgLoaded++
})

//読み込み状況アップデート関数
function updateProgress() {

  //ローディング演出用の計算
  progressCount += (imgLoaded / imgTotal) * progressSpeed;

  if(progressCount >= 100 && imgTotal > imgLoaded) {
    //カウントは100以上だが画像の読み込みが終わってない
    progressResult = 99;
  } else if(progressCount > 99.9) {
    //カウントが100以上になった
    progressResult = 100;
  } else {
    //現在のカウント
    progressResult = progressCount;
  }

  //ローディング進捗状況をプログレスバーと数字で表示
  progressBar.style.width = progressResult + '%';
  progressNumber.innerText = Math.floor(progressResult);

  //ローディング完了後 0.8秒待ってページを表示
  if (progressResult >= 100 && imgTotal == imgLoaded) {
    clearInterval(progressInit);
    setTimeout(function () {
		
		
		 Tween24.serial(
	 
	  Tween24.tween(".js-loader-progress", 0.3).opacity(0).y(0)
	 
	 .onComplete(function () {    //complete func
	$(".js-loader").hide(0);
}  
	  ),
	
	 
	  Tween24.tween(".loading_logo", 0.3).opacity(0).y(10),
	 
			 
			  //slide
	/*  Tween24.parallel(   
		  	 Tween24.prop("#pc_top_03,#pc_top_04,.fusen_set__pc").opacity(0).y(20),
		  Tween24.prop("#trailer-item").opacity(0),
	 Tween24.tween(".loader_cover-up", 1,Ease24._5_QuintInOut).opacity(1).y("-100%"),
	Tween24.tween(".loader_cover-down", 1,Ease24._5_QuintInOut).opacity(1).y("100%"),
		   Tween24.prop("#splash").pointerEvents(false)
		  )*/
			 
			 
			   Tween24.parallel( 
		  	 Tween24.prop("#cp_01,#cp_02,.fusen_set__pc").opacity(0).y(20),
		  Tween24.prop("#trailer-item").opacity(0),
	 Tween24.tween(".loader_cover-up", 1,Ease24._5_QuintInOut).opacity(0),
	Tween24.tween(".loader_cover-down", 1,Ease24._5_QuintInOut).opacity(0),
		   Tween24.prop("#splash").pointerEvents(false)
		  )
			 
			 .onComplete(function () {    //complete func
	splashScreen();
}  
	  )
	  
).play();
		
		
		
		
      //document.querySelector('body').classList.add('is-loaded');
    }, 500);
  }
}