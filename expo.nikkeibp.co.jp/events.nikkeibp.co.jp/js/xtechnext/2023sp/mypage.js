(function(){const g={score:"nes_xtechnext2023sp_score",booth:"nes_xtechnext2023sp_booth",category:"nes_xtechnext2023sp_category"};const a={seminars:"セミナー","native-tieups":"ソリューション／事例紹介",docs:"資料ダウンロード",movies:"資料動画",news:"出展社ニュース",novelties:"ノベルティ"};const b=$("#main").data("device");const h=b==="pc"?"26":"18";const e=$("#main").data("dir");const j="/images/"+e+"/";const c=new Date();const d=String(c.getFullYear())+String(c.getMonth())+String(c.getDate())+String(c.getHours());const f="/js/"+e+"/data/shozai.xml?Date="+d;$(function(){if($("#boothList").length>0){$.ajax({url:"/pds/userdb/?MAXCNT=200&service="+g.booth,type:"get",cache:false}).done(function(m){if(m.data.length>0){$.ajax({url:f,type:"get",dataType:"XML"}).done(function(n){m.data.forEach(function(o){k(o.obj.url,o.obj.exhibitid,o.obj.exhibitname,o.id,n)})})}})}function k(n,o,q,p,m){let html="";html+='<section class="l-section">';html+='<div class="l-container">';html+='<div class="mypage_head">';html+='<h2 class="mypage_title"><a href="'+n+'">'+q+"</a></h2>";html+='<button class="delete-btn" type="button" data-did="'+p+'">削除</button>';html+="</div>";html+='<ul class="mypage_list">';$(m).find("items item").each(function(r,s){let type=$(s).find("type").text();let title=$(s).find("title").text();let exhibitName=$(s).find("exhibitName").text();let exhibitId=$(s).find("exhibitId").text();let path=$(s).find("path").text().replace("/sites/events.nikkeibp.co.jp","").replace("index-2.html","");if(exhibitId==o){html+='<li class="mypage_list_item">';html+='<div class="category">';html+='<span class="ico"><img src="'+j+"ico_"+type+'.svg" alt="" width="'+h+'" height="'+h+'"></span>';html+="<span>"+a[type]+"</span>";html+="</div>";html+='<p class="seminar-title"><a href="'+path+'">'+title+"</a></p>";html+="</li>"}});html+="</div>";html+="</section>";$("#boothList").append(html);$("#boothList .delete-btn").on("click",function(){let p=$(this).attr("data-did");l(p);return false})}function l(m){$.ajax({type:"GET",url:"/pds/userdb/delete/"+m,dataType:"json",data:{chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")}}).done(function(n){if(n.statusCode=="200"||n.errorReason=="INVALID_OBJ_ID"){$(document).find('#boothList button[data-did="'+m+'"]').closest("section").remove()}})}});$(function(){const n=function(p){const q=$.Deferred();$.ajax({url:"/pds/userdb/?MAXCNT="+l+"&service="+g.category,type:"get"}).done(function(r){let id="";let isRegistered=false;r.data.forEach(function(s){if(s.obj.category==p){id=s.id;isRegistered=true}});q.resolve({isRegistered:isRegistered,id:id})}).fail(function(){q.reject()});return q.promise()};const l=5;let categories={};if($("#categoryList").length>0){$("form").find('[name="mycategory"]').each(function(){categories[$(this).val()]=$('label[for="'+$(this).attr("id")+'"]').text()});$(".search_list").hide();let section="";Object.keys(categories).forEach(function(p){section+='<section class="l-section" data-cate="'+p+'"></section>'});$("#categoryList").append(section);$.ajax({url:f,type:"get",dataType:"XML"}).done(function(p){$.ajax({url:"/pds/userdb/?MAXCNT="+l+"&service="+g.category,type:"get"}).done(function(q){$(".search_list").show();for(let i=0;i<q.data.length;i++){let category=q.data[i].obj.category;$(document).find('.search_list li input[value="'+category+'"]').attr("data-did",q.data[i].id);$(document).find('.search_list li input[value="'+category+'"]').prop("checked",true);m(category,p)}$(".search_list li input").on("change",function(){if($(".search_list li input:checked").length<=l){const r=$(this);if($(this).prop("checked")){n($(this).val()).then(function(s){if(s.isRegistered){r.attr("data-did",s.id);m(r.val(),p)}else{k(r.val(),r,p)}}).fail(function(){alert("エラーが発生しました。ページを再読み込みの上、改めて設定してください。");r.prop("checked",false)})}else{o($(this).val(),$(this).attr("data-did"),$(this))}}else{alert("選択できるカテゴリーは"+l+"件までです");$(this).prop("checked",false)}})})})}function k(r,p,q){const t={category:r,site:"NES"};const s={obj:JSON.stringify(t),service:g.category,callback:"",chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")};$.ajax({type:"POST",url:"/pds/userdb/create/",dataType:"json",data:s}).done(function(u){if(u.statusCode=="200"){$(p).attr("data-did",u.data.id);m(r,q)}else{if(u.errorReason=="EXCEED_ENTRIES"){alert("既に"+l+"件登録されています。ページを再読み込みしてください。");$(p).prop("checked",false)}else{alert("エラーが発生しました");$(p).prop("checked",false)}}}).fail(function(){alert("エラーが発生しました");$(p).prop("checked",false)})}function o(r,q,p){$.ajax({type:"GET",url:"/pds/userdb/delete/"+q,dataType:"json",data:{chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")}}).done(function(s){if(s.statusCode=="200"||s.errorReason=="INVALID_OBJ_ID"){$(p).prop("checked",false);$(document).find('section [data-cate="'+r+'"]').empty()}else{alert("エラーが発生しました");$(p).prop("checked",true)}})}function m(q,p){let html="";html+='<div class="l-container">';html+='<div class="mypage_head">';html+='<h2 class="mypage_title">'+categories[q]+"</h2>";html+="</div>";html+='<ul class="mypage_list">';$(p).find("items item").each(function(r,s){let type=$(s).find("type").text();let title=$(s).find("title").text();let exhibitName=$(s).find("exhibitName").text();let path=$(s).find("path").text().replace("../../../index.html","").replace("index-2.html","");let viewFlag=false;$(s).find("themes theme").each(function(t,u){if($(u).find("id").text()==q){viewFlag=true}});if(viewFlag){html+='<li class="mypage_list_item">';html+='<div class="category">';html+='<span class="ico"><img src="'+j+"ico_"+type+'.svg" alt="" width="'+h+'" height="'+h+'"></span>';html+="<span>"+a[type]+"</span>";html+="</div>";html+='<p class="seminar-title"><a href="'+path+'"><span class="sub">'+exhibitName+"</span>"+title+"</a></p>";html+="</li>"}});html+="</ul>";html+="</div>";$(document).find('#categoryList section[data-cate="'+q+'"]').html(html)}});$(function(){if($("#scoreList").length>0){const k=100;$.ajax({url:"/pds/userdb/?MAXCNT=1000&service="+g.score,type:"get"}).done(function(m){if(m.data.length>0){const l=m.data.length;let score=0;let html="";m.data.forEach(function(n,o){html+='<li class="mypage_list_item"'+(o>=k?' style="display:none;"':"")+">";html+='<div class="category">';html+='<span class="ico"><img src="'+j+"ico_"+n.obj.type+'.svg" alt="" width="'+h+'" height="'+h+'"></span>';html+="<span>"+a[n.obj.type]+"</span>";html+="</div>";html+='<p class="seminar-title"><a href="'+n.obj.path.replace("/sites/events.nikkeibp.co.jp","").replace("index-2.html","")+'"><span class="sub">'+n.obj.exhibitName+"</span>"+n.obj.title+"</a></p>";html+="</li>";score=score+Number(n.obj.score)});$(".score_num").text(score);$("#scoreList").html(html);if(l>k){$(".js-moreBtn").show()}let num=k;$(".js-moreBtn").on("click",function(){num+=k;$(this).siblings().find("li:lt("+num+")").show(400);if(l<=num){$(".js-moreBtn").hide(300)}})}})}})})();