(function(){$(function(){$(".article_action_btn_label.-urlcopy").on("click",function(d){d.preventDefault();if(navigator.clipboard){navigator.clipboard.writeText(location.href)}else{window.clipboardData.setData("Text",location.href)}$(this).addClass("-copied");setTimeout(function(){$(this).removeClass("-copied")}.bind(this),2000)});$(".shareBox_action_btn_label.-urlcopy").on("click",function(d){d.preventDefault();if(navigator.clipboard){navigator.clipboard.writeText(location.href)}else{window.clipboardData.setData("Text",location.href)}$.magnificPopup.close();$(this).addClass("-copied");$(".js-modalShare").after('<span class="-clip_text -copied">URLを<br>コピーしました</span>');setTimeout(function(){$(".fixedShare .-clip_text").remove()}.bind(this),2000)})});const a={score:"nes_dinv2022sp_score",booth:"nes_dinv2022sp_booth",category:"nes_dinv2022sp_category"};$(function(){const h=$(".article_action_btn_label.-clip");if(h.length>0&&!h.hasClass("applyForGuest")){var j=h.attr("data-boothurl");$.ajax({url:"/pds/userdb/?MAXCNT=200&service="+a.booth,type:"get"}).done(function(m){const l=[];m.data.forEach(function(n){l.push(n.obj.url)});for(let i=0;i<m.data.length;i++){if(m.data[i].obj.url===j){h.attr("data-did",m.data[i].id)}}if(l.indexOf(j)>-1){h.addClass("-clipped");h.attr("title","気になるブースから削除する")}else{h.removeClass("-clipped");h.attr("title","気になるブースに追加する")}e()})}function e(){h.on("click",function(){h.css("pointer-events","none");if(h.hasClass("-clipped")){const n=h.attr("data-did");g(n);h.attr("title","気になるブースに追加する")}else{const m={url:h.attr("data-boothurl"),exhibitname:h.attr("data-exhibitname"),exhibitid:h.attr("data-exhibitid"),site:"NES"};const l={obj:JSON.stringify(m),service:a.booth,callback:"",chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")};$.ajax({type:"POST",url:"/pds/userdb/create/",dataType:"json",data:l}).done(function(o){if(o.statusCode=="200"){h.addClass("-clipped");h.after('<span class="-clip_text">気になるブースに追加しました</span>');h.attr("data-did",o.data.id);h.attr("title","気になるブースから削除する");setTimeout(function(){h.closest("li").find(".-clip_text").css("display","none");h.css("pointer-events","auto")}.bind(this),1000)}else{if(o.errorReason=="EXCEED_ENTRIES"){alert("「気になるブース」は最大200件です。");h.css("pointer-events","auto")}else{if(o.errorReason=="TOKEN_TIMEOUT"){alert("接続の有効時間が切れました。ページを再読み込みの上、改めて設定してください。");h.css("pointer-events","auto")}}}return false})}return false})}function g(l){$.ajax({type:"GET",url:"/pds/userdb/delete/"+l,dataType:"json",data:{chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")}}).done(function(m){if(m.statusCode=="200"){h.removeClass("-clipped");h.css("pointer-events","auto");h.attr("data-did")}})}const k=$(".shareBox_action_btn_label.-clip");if(k.length>0&&!k.hasClass("applyForGuest")){var j=k.attr("data-boothurl");$.ajax({url:"/pds/userdb/?MAXCNT=200&service="+a.booth,type:"get"}).done(function(m){const l=[];m.data.forEach(function(n){l.push(n.obj.url)});for(let i=0;i<m.data.length;i++){if(m.data[i].obj.url==j){k.attr("data-did",m.data[i].id)}}if(l.indexOf(j)>-1){k.addClass("-clipped").text("気になるブースに追加済")}else{k.removeClass("-clipped");k.text("気になるブースに追加")}f()})}function f(){k.on("click",function(){k.css("pointer-events","none");if(k.hasClass("-clipped")){const n=k.attr("data-did");d(n);k.text("気になるブースに追加")}else{const m={url:k.attr("data-boothurl"),exhibitname:k.attr("data-exhibitname"),exhibitid:k.attr("data-exhibitid"),site:"NES"};const l={obj:JSON.stringify(m),service:a.booth,callback:"",chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")};$.ajax({type:"POST",url:"/pds/userdb/create/",dataType:"json",data:l}).done(function(o){if(o.statusCode=="200"){k.addClass("-clipped").text("気になるブースに追加済");$.magnificPopup.close();$(".js-modalShare").after('<span class="-clip_text -clipped">気になるブースに<br>追加しました</span>');k.attr("data-did",o.data.id);setTimeout(function(){$(".fixedShare .-clip_text").remove();k.css("pointer-events","auto")}.bind(this),2000)}else{if(o.errorReason=="EXCEED_ENTRIES"){alert("「気になるブース」は最大200件です。");k.css("pointer-events","auto")}else{if(o.errorReason=="TOKEN_TIMEOUT"){alert("接続の有効時間が切れました。ページを再読み込みの上、改めて設定してください。");k.css("pointer-events","auto")}}}return false})}return false})}function d(l){$.ajax({type:"GET",url:"/pds/userdb/delete/"+l,dataType:"json",data:{chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")}}).done(function(m){if(m.statusCode=="200"){$.magnificPopup.close();k.removeClass("-clipped");k.css("pointer-events","auto");k.attr("data-did");k.text("気になるブースに追加")}})}});$(function(){const g=$("#js-addActionScore");if(g.length>0){const h=g.attr("data-path");$.ajax({url:"/pds/userdb/?MAXCNT=1000&service="+a.score,type:"get"}).done(function(k){const j=[];k.data.forEach(function(l){j.push(l.obj.path)});if(j.indexOf(h)>-1){g.addClass("nolink");g.text("アクションスコアに登録済みです")}else{g.addClass("c-btn").removeClass("nolink");g.closest(".button").addClass("pink");d()}})}function d(){const j={"native-tieups":30,seminars:40,news:10,movies:20,"theme-docs-pages":1,docs:20,"theme-movies-pages":1,novelties:1};g.on("click",function(m){g.css("pointer-events","none");const p=g.attr("data-path");const q=g.attr("data-title");const k=g.attr("data-type");const l=g.attr("data-exhibitname");const o={path:p,title:q,type:k,score:j[k],exhibitName:l,site:"NES"};const n={obj:JSON.stringify(o),service:a.score,callback:"",chk_token:$('meta[name="bpcmstokenmydata"]').attr("content")};$.ajax({type:"POST",url:"/pds/userdb/create/",dataType:"json",data:n}).done(function(r){if(r.statusCode=="200"){alert("アクションスコアに登録しました");g.off("click");g.addClass("nolink").removeClass("c-btn");g.closest(".button").removeClass("pink");g.text("アクションスコアに登録済みです")}else{if(r.errorReason=="EXCEED_ENTRIES"){alert("「アクションスコア」は最大1000件です。");g.css("pointer-events","auto")}else{if(r.errorReason=="TOKEN_TIMEOUT"){alert("接続の有効時間が切れました。ページを再読み込みの上、改めて設定してください。");g.css("pointer-events","auto")}}}});m.preventDefault()})}const f=$("#js-checkActionScore");if(f.length){if(f.data("article")==="seminar"){const e=f.attr("data-path");$.ajax({url:"/pds/userdb/?MAXCNT=1000&service="+a.score,type:"get"}).done(function(k){const j=[];k.data.forEach(function(l){j.push(l.obj.path)});if(j.indexOf(e)>-1){f.text("アクションスコアに登録済みです")}})}}});if($('a[data-atlas-trackable="body_exlink"]').length>0){const b=$('meta[name="movielogid"]').attr("content");const c=$('meta[name="seminarcode"]').attr("content");$('.articleBody a[data-atlas-trackable="body_exlink"]').each(function(d,e){$(this).attr("href",$(this).attr("data-url")+"?p=nbp."+c+"."+b);$(this).off("click")})}})();