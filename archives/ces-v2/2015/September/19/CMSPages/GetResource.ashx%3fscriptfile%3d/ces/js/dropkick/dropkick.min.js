!function(n,t,r){n.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);n.isIframe=n.parent!=n.self&&location.host===parent.location.host;var f={},o=0,e=function(i,r){var o;return n.isMobile&&!r.mobile?!1:this===n?new e(i,r):("string"==typeof i&&"#"===i[0]&&(i=t.getElementById(i.substr(1))),(o=i.getAttribute("data-dkcacheid"))?(u.extend(f[o].data.settings,r),f[o]):"SELECT"===i.nodeName?this.init(i,r):void 0)},s=function(){},h={initialize:s,change:s,open:s,close:s,search:"strict"},u={hasClass:function(n,t){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return n&&i.test(n.className)},addClass:function(n,t){n&&!u.hasClass(n,t)&&(n.className+=" "+t)},removeClass:function(n,t){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");n&&(n.className=n.className.replace(i," "))},toggleClass:function(n,t){var i=u.hasClass(n,t)?"remove":"add";u[i+"Class"](n,t)},extend:function(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t)for(var i in t)n[i]=t[i]}),n},offset:function(i){var r=i.getBoundingClientRect()||{top:0,left:0},u=t.documentElement;return{top:r.top+n.pageYOffset-u.clientTop,left:r.left+n.pageXOffset-u.clientLeft}},position:function(n,t){for(var i={top:0,left:0};n!==t;)i.top+=n.offsetTop,i.left+=n.offsetLeft,n=n.parentNode;return i},closest:function(n,t){for(;n;){if(n===t)return n;n=n.parentNode}return!1},create:function(n,i){var r,u=t.createElement(n);i||(i={});for(r in i)i.hasOwnProperty(r)&&("innerHTML"==r?u.innerHTML=i[r]:u.setAttribute(r,i[r]));return u}};e.prototype={add:function(n,i){var e,r,f;"string"==typeof n&&(e=n,n=t.createElement("option"),n.text=e);"OPTION"===n.nodeName&&(r=u.create("li",{"class":"dk-option","data-value":n.value,innerHTML:n.text,role:"option","aria-selected":"false",id:"dk"+this.data.cacheID+"-"+(n.id||n.value.replace(" ","-"))}),u.addClass(r,n.className),this.length+=1,n.disabled&&(u.addClass(r,"dk-option-disabled"),r.setAttribute("aria-disabled","true")),this.data.select.add(n,i),"number"==typeof i&&(i=this.item(i)),this.options.indexOf(i)>-1?i.parentNode.insertBefore(r,i):this.data.elem.lastChild.appendChild(r),r.addEventListener("mouseover",this),f=this.options.indexOf(i),this.options.splice(f,0,r),n.selected&&this.select(f))},item:function(n){return n=0>n?this.options.length+n:n,this.options[n]||null},remove:function(n){var t=this.item(n);t.parentNode.removeChild(t);this.options.splice(n,1);this.data.select.remove(n);this.select(this.data.select.selectedIndex);this.length-=1},init:function(i,r){var s,c=e.build(i,"dk"+o);if(this.data={},this.data.select=i,this.data.elem=c.elem,this.data.settings=u.extend({},h,r),this.disabled=i.disabled,this.form=i.form,this.length=i.length,this.multiple=i.multiple,this.options=c.options.slice(0),this.selectedIndex=i.selectedIndex,this.selectedOptions=c.selected.slice(0),this.value=i.value,i.parentNode.insertBefore(this.data.elem,i),this.data.elem.addEventListener("click",this),this.data.elem.addEventListener("keydown",this),this.data.elem.addEventListener("keypress",this),this.form&&this.form.addEventListener("reset",this),!this.multiple)for(s=0;s<this.options.length;s++)this.options[s].addEventListener("mouseover",this);return 0===o&&(t.addEventListener("click",e.onDocClick),n.isIframe&&parent.document.addEventListener("click",e.onDocClick)),this.data.cacheID=o,i.setAttribute("data-dkCacheId",this.data.cacheID),f[this.data.cacheID]=this,this.data.settings.initialize.call(this),o+=1,this},close:function(){var n=this.data.elem;if(!this.isOpen||this.multiple)return!1;for(i=0;i<this.options.length;i++)u.removeClass(this.options[i],"dk-option-highlight");n.lastChild.setAttribute("aria-expanded","false");u.removeClass(n.lastChild,"dk-select-options-highlight");u.removeClass(n,"dk-select-open-(up|down)");this.isOpen=!1;this.data.settings.close.call(this)},open:function(){var r,f,e,t=this.data.elem,i=t.lastChild,o=u.offset(t).top-n.scrollY,s=n.innerHeight-(o+t.offsetHeight);return this.isOpen||this.multiple?!1:(i.style.display="block",r=i.offsetHeight,i.style.display="",f=o>r,e=s>r,direction=f&&!e?"-up":"-down",this.isOpen=!0,u.addClass(t,"dk-select-open"+direction),i.setAttribute("aria-expanded","true"),this._scrollTo(this.options.length-1),this._scrollTo(this.selectedIndex),void this.data.settings.open.call(this))},disable:function(n,t){var i="dk-option-disabled";(0==arguments.length||"boolean"==typeof n)&&(t=n===r?!0:!1,n=this.data.elem,i="dk-select-disabled",this.disabled=t);t==r&&(t=!0);"number"==typeof n&&(n=this.item(n));u[t?"addClass":"removeClass"](n,i)},select:function(n,t){var i,f,r,e,o=this.data.select;if("number"==typeof n&&(n=this.item(n)),"string"==typeof n)for(i=0;i<this.length;i++){if(this.options[i].getAttribute("data-value")!=n)return!1;n=this.options[i]}return!t&&u.hasClass(n,"dk-option-disabled")?!1:u.hasClass(n,"dk-option")?(f=this.options.indexOf(n),r=o.options[f],this.multiple?(u.toggleClass(n,"dk-option-selected"),r.selected=!r.selected,u.hasClass(n,"dk-option-selected")?(n.setAttribute("aria-selected","true"),this.selectedOptions.push(n)):(n.setAttribute("aria-selected","false"),f=this.selectedOptions.indexOf(n),this.selectedOptions.splice(f,1))):(e=this.data.elem.firstChild,this.selectedOptions.length&&(u.removeClass(this.selectedOptions[0],"dk-option-selected"),this.selectedOptions[0].setAttribute("aria-selected","false")),u.addClass(n,"dk-option-selected"),n.setAttribute("aria-selected","true"),e.setAttribute("aria-activedescendant",n.id),e.innerHTML=r.text,this.selectedOptions[0]=n,r.selected=!0),this.selectedIndex=o.selectedIndex,this.value=o.value,this.data.settings.change.call(this),n):void 0},selectOne:function(n,t){return this.reset(!0),this._scrollTo(n),this.select(n,t)},search:function(n,t){var i,s,f,e,o,r,h,c,l=this.data.select.options,u=[];if(!n)return this.options;for(t=t?t.toLowerCase():"strict",t="fuzzy"==t?2:"partial"==t?1:0,c=new RegExp((t?"":"^")+n,"i"),i=0;i<l.length;i++)if(f=l[i].text.toLowerCase(),2==t){for(s=n.toLowerCase().split(""),e=o=r=h=0;o<f.length;)f[o]===s[e]?(r+=1+r,e++):r=0,h+=r,o++;e==s.length&&u.push({e:this.options[i],s:h,i:i})}else c.test(f)&&u.push(this.options[i]);return 2==t&&(u=u.sort(function(n,t){return t.s-n.s||n.i-t.i}).reduce(function(n,t){return n[n.length]=t.e,n},[])),u},reset:function(n){var t,i=this.data.select;for(this.selectedOptions.length=0,t=0;t<i.options.length;t++)i.options[t].selected=!1,u.removeClass(this.options[t],"dk-option-selected"),this.options[t].setAttribute("aria-selected","false"),!n&&i.options[t].defaultSelected&&this.select(t,!0);this.selectedOptions.length||this.multiple||this.select(0,!0)},refresh:function(){this.dispose().init(this.data.select,this.data.settings)},dispose:function(){return delete f[this.data.cachID],this.data.elem.parentNode.removeChild(this.data.elem),this.data.select.removeAttribute("data-dkCacheId"),this},handleEvent:function(n){if(!this.disabled)switch(n.type){case"click":this._delegate(n);break;case"keydown":this._keyHandler(n);break;case"keypress":this._searchOptions(n);break;case"mouseover":this._highlight(n);break;case"reset":this.reset()}},_delegate:function(t){var o,i,e,r,f=t.target;if(u.hasClass(f,"dk-option-disabled"))return!1;if(this.multiple){if(u.hasClass(f,"dk-option"))if(o=n.getSelection(),"Range"==o.type&&o.collapseToStart(),t.shiftKey)if(e=this.options.indexOf(this.selectedOptions[0]),r=this.options.indexOf(this.selectedOptions[this.selectedOptions.length-1]),i=this.options.indexOf(f),i>e&&r>i&&(i=e),i>r&&r>e&&(r=e),this.reset(!0),r>i)for(;r+1>i;)this.select(i++);else for(;i>r-1;)this.select(i--);else t.ctrlKey||t.metaKey?this.select(f):(this.reset(!0),this.select(f))}else this[this.isOpen?"close":"open"](),u.hasClass(f,"dk-option")&&this.select(f)},_highlight:function(n){var t,i=n.target;if(!this.multiple){for(t=0;t<this.options.length;t++)u.removeClass(this.options[t],"dk-option-highlight");u.addClass(this.data.elem.lastChild,"dk-select-options-highlight");u.addClass(i,"dk-option-highlight")}},_keyHandler:function(n){var f,e=this.selectedOptions,r=this.options,t=1,i={tab:9,enter:13,esc:27,space:32,up:38,down:40};switch(n.keyCode){case i.up:t=-1;case i.down:n.preventDefault();f=e[e.length-1];t=r.indexOf(f)+t;t>r.length-1?t=r.length-1:0>t&&(t=0);this.data.select.options[t].disabled||(this.reset(!0),this.select(t),this._scrollTo(t));break;case i.space:if(!this.isOpen){n.preventDefault();this.open();break}case i.tab:case i.enter:for(t=0;t<r.length;t++)u.hasClass(r[t],"dk-option-highlight")&&this.select(t);case i.esc:this.isOpen&&(n.preventDefault(),this.close())}},_searchOptions:function(n){var t,i=this,f=String.fromCharCode(n.keyCode||n.which),e=function(){i.data.searchTimeout&&clearTimeout(i.data.searchTimeout);i.data.searchTimeout=setTimeout(function(){i.data.searchString=""},1e3)};this.data.searchString===r&&(this.data.searchString="");e();this.data.searchString+=f;t=this.search(this.data.searchString,this.data.settings.search);t.length&&(u.hasClass(t[0],"dk-option-disabled")||this.selectOne(t[0]))},_scrollTo:function(n){var i,r,f,t=this.data.elem.lastChild;return this.isOpen||this.multiple?("number"==typeof n&&(n=this.item(n)),i=u.position(n,t).top,r=i-t.scrollTop,f=r+n.offsetHeight,void(f>t.offsetHeight?(i+=n.offsetHeight,t.scrollTop=i-t.offsetHeight):0>r&&(t.scrollTop=i))):!1}};e.build=function(n,t){var r,f,e=[],i={elem:null,options:[],selected:[]},o=function(n){var r,f,e,s,h=[];switch(n.nodeName){case"OPTION":r=u.create("li",{"class":"dk-option","data-value":n.value,innerHTML:n.text,role:"option","aria-selected":"false",id:t+"-"+(n.id||n.value.replace(" ","-"))});u.addClass(r,n.className);n.disabled&&(u.addClass(r,"dk-option-disabled"),r.setAttribute("aria-disabled","true"));n.selected&&(u.addClass(r,"dk-option-selected"),r.setAttribute("aria-selected","true"),i.selected.push(r));i.options.push(this.appendChild(r));break;case"OPTGROUP":for(f=u.create("li",{"class":"dk-optgroup"}),n.label&&f.appendChild(u.create("div",{"class":"dk-optgroup-label",innerHTML:n.label})),e=u.create("ul",{"class":"dk-optgroup-options"}),s=n.children.length;s--;h.unshift(n.children[s]));h.forEach(o,e);this.appendChild(f).appendChild(e)}};for(i.elem=u.create("div",{"class":"dk-select"+(n.multiple?"-multi":"")}),r=u.create("ul",{"class":"dk-select-options",id:t+"-listbox",role:"listbox"}),n.disabled&&u.addClass(i.elem,"dk-select-disabled"),i.elem.id=t+(n.id?"-"+n.id:""),u.addClass(i.elem,n.className),n.multiple?(i.elem.setAttribute("tabindex",n.getAttribute("tabindex")||"0"),r.setAttribute("aria-multiselectable","true")):(i.elem.appendChild(u.create("div",{"class":"dk-selected",tabindex:n.tabindex||0,innerHTML:n.options[n.selectedIndex].text,id:t+"-combobox","aria-live":"assertive","aria-owns":r.id,role:"combobox"})),r.setAttribute("aria-expanded","false")),f=n.children.length;f--;e.unshift(n.children[f]));return e.forEach(o,i.elem.appendChild(r)),i};e.onDocClick=function(n){var r,e,i;(r=t.getElementById(n.target.htmlFor))&&null!==(e=r.getAttribute("data-dkcacheid"))&&f[e].data.elem.focus();for(i in f)u.closest(n.target,f[i].data.elem)||f[i].disabled||f[i].close()};n.Dropkick=e}(window,document)