var characters = {
	mario : {
		name : "Mario",
		charName : "img/characters/name_mario.png",
		charDesc : "Un fontanero superalegre y popular. Se enfrenta a Bowser con su habilidad para saltar y sus cualidades atléticas.",
		charImg : "img/characters/mario.png",
		charImgLg : "img/characters/mario_lg.png"
	},
	luigi: {
		name : "Luigi",
		charName : "img/characters/name_luigi.png",
		charDesc : "El hermano pequeño de Mario. Es un poco tímido (sobre todo cuando hay fantasmas), pero es tan amable y genial como su hermano.",
		charImg : "img/characters/luigi.png",
		charImgLg : "img/characters/luigi_lg.png"
	},
	peach: {
		name : "Peach",
		charName : "img/characters/name_peach.png",
		charDesc : "La princesa del Reino Champiñón. Le unen grandes lazos afectivos con Mario y siempre es gentil. Le encanta cocinar.",
		charImg : "img/characters/peach.png",
		charImgLg : "img/characters/peach_lg.png"
	},
	yoshi: {
		name : "Yoshi",
		charName : "img/characters/name_yoshi.png",
		charDesc : "El amable y tranquilo aliado de Mario. Su larga lengua le permite comer fruta y enemigos y convertirlos en huevos.",
		charImg : "img/characters/yoshi.png",
		charImgLg : "img/characters/yoshi_lg.png"
	},
	bowser: {
		name : "Bowser",
		charName : "img/characters/name_bowser.png",
		charDesc : "La fuerza del Rey de los Koopas, su aliento de fuego y su ejército de Goombas y Koopas lo convierten en una amenaza para la paz mundial.",
		charImg : "img/characters/bowser.png",
		charImgLg : "img/characters/bowser.png"
	},
	sonic: {
		name : "Sonic",
		charName : "img/characters/name_sonic.png",
		charDesc : "El erizo más rápido del mundo. Puede ser un poco impulsivo e impaciente, pero su corazón es tan grande como su sentido de la justicia.",
		charImg : "img/characters/sonic.png",
		charImgLg : "img/characters/sonic_lg.png"
	},
	knuckles: {
		name : "Knuckles",
		charName : "img/characters/name_knuckles.png",
		charDesc : "Un poderoso equidna que vive en Angel Island. Es el único guardián de la Master Emerald.",
		charImg : "img/characters/knuckles.png",
		charImgLg : "img/characters/knuckles_lg.png"
	},
	tails: {
		name : "Tails",
		charName : "img/characters/name_tails.png",
		charDesc : "Un zorrito de dos colas. Puede hacer girar sus colitas y echar a volar. Además, es un cerebrito y acompaña a Sonic en sus aventuras.",
		charImg : "img/characters/tails.png",
		charImgLg : "img/characters/tails_lg.png"
	},
	amy: {
		name : "Amy",
		charName : "img/characters/name_amy.png",
		charDesc : "Una eriza tan determinada como alegre. Es muy cabezota, pero jamás duda a la hora de enfrentarse al mal con su martillo favorito.",
		charImg : "img/characters/amy.png",
		charImgLg : "img/characters/amy_lg.png"
	},
	eggman: {
		name : "Eggman",
		charName : "img/characters/name_eggman.png",
		charDesc : "Un autodenominado científico malvado y genio mecánico con un coeficiente intelectual de 300. No cesa en su empeño de dominar el mundo.",
		charImg : "img/characters/robotnik.png",
		charImgLg : "img/characters/robotnik_lg.png"
	},
	daisy: {
		name : "Daisy",
		charName : "img/characters/name_daisy.png",
		charDesc : "La princesa de Sarasaland. Es feliz, activa y siempre llena de energía.",
		charImg : "img/characters/daisy.png",
		charImgLg : "img/characters/daisy_lg.png"
	},
	wario: {
		name : "Wario",
		charName : "img/characters/name_wario.png",
		charDesc : "Con Wario no hay quién se aburra. Es escandaloso, chulito y considera a Mario su rival. Le encanta el ajo y el dinero.",
		charImg : "img/characters/wario.png",
		charImgLg : "img/characters/wario_lg.png"
	},
	waluigi: {
		name : "Waluigi",
		charName : "img/characters/name_waluigi.png",
		charDesc : "El amigo de Wario. Considera a Luigi su rival. Sus alargadas extremidades lo convierten en un oponente a batir en todas las competiciones.",
		charImg : "img/characters/waluigi.png",
		charImgLg : "img/characters/waluigi_lg.png"
	},
	donkeykong: {
		name : "Donkey Kong",
		charName : "img/characters/name_donkeykong.png",
		charDesc : "El rey de la jungla y la estrella de la familia Kong. Tiene una fuerza increíble y hará lo que esté en su mano por conseguir plátanos.",
		charImg : "img/characters/donkeykong.png",
		charImgLg : "img/characters/donkeykong.png"
	},
	bowserjr: {
		name : "Bowser Jr.",
		charName : "img/characters/name_bowserjr.png",
		charDesc : "El hijo del Rey de los Koopas. Es un renacuajo, pero tiene la fuerza y el egoísmo de su padre. Lleva una máscara con una bocaza dibujada.",
		charImg : "img/characters/bowserjr.png",
		charImgLg : "img/characters/bowserjr_lg.png"
	},
	shadow: {
		name : "Shadow",
		charName : "img/characters/name_shadow.png",
		charDesc : "Un erizo negro creado con un cuerpo inmortal. Usa las Chaos Emeralds para modificar el espacio y el tiempo.",
		charImg : "img/characters/shadow.png",
		charImgLg : "img/characters/shadow_lg.png"
	},
	silver: {
		name : "Silver",
		charName : "img/characters/name_silver.png",
		charDesc : "Un erizo proveniente del futuro. Tiene un gran sentido de la justicia. Su poderosa psicoquinesia le permite mover objetos y levitar.",
		charImg : "img/characters/silver.png",
		charImgLg : "img/characters/silver_lg.png"
	},
	metalsonic: {
		name : "Metal Sonic",
		charName : "img/characters/name_metalsonic.png",
		charDesc : "Robot de alto rendimiento construido por el Dr. Eggman a imagen de Sonic. Tiene la velocidad y potencia de Sonic, pero es uno de los obedientes secuaces de Eggman.",
		charImg : "img/characters/metalsonic.png",
		charImgLg : "img/characters/metalsonic_lg.png"
	},
	blaze: {
		name : "Blaze",
		charName : "img/characters/name_blaze.png",
		charDesc : "AUna princesa de otro mundo que usa las Sol Emeralds que protege. Es calmada, un poco tímida y puede que demasiado exigente consigo misma.",
		charImg : "img/characters/blaze.png",
		charImgLg : "img/characters/blaze_lg.png"
	},
	vector: {
		name : "Vector",
		charName : "img/characters/name_vector.png",
		charDesc : "El jefe de la agencia de detectives Chaotix. Es muy espabilado y no se corta un pelo. También es optimista y tiene un gran corazón.",
		charImg : "img/characters/vector.png",
		charImgLg : "img/characters/vector_lg.png"
	}
};
	//preloader
	function preloader() {
		jQuery('#loader-bg').delay(900).fadeOut(800);
		jQuery('#loader').delay(600).fadeOut(300);
	}
	

//using window.load rather than putting in document.ready so that the site loads faster and then caches the images. Initial character, in this case mario is not in the array as those images are already loaded. Function below calls itself and loads the images. Nothing is done with them but, they do cache. Can see this in the network tab of the console.

jQuery(window).on('load', function(){
	preloader();
	var images = ["img/characters/amy_lg.png", "img/characters/amy.png", "img/characters/blaze.png", "img/characters/blaze_lg.png", "img/characters/bowser.png", "img/characters/bowserjr_lg.png", "img/characters/bowserjr.png", "img/characters/daisy_lg.png", "img/characters/daisy.png", "img/characters/donkeykong.png", "img/characters/knuckles_lg.png", "img/characters/knuckles.png", "img/characters/luigi_lg.png", "img/characters/luigi.png", "img/characters/mario_lg.png", "img/characters/mario.png", "img/characters/metalsonic_lg.png", "img/characters/metalsonic.png", "img/characters/peach_lg.png", "img/characters/peach.png", "img/characters/robotnik_lg.png", "img/characters/robotnik.png", "img/characters/shadow_lg.png", "img/characters/shadow.png", "img/characters/silver_lg.png", "img/characters/silver.png", "img/characters/sonic_lg.png", "img/characters/sonic.png", "img/characters/tails_lg.png", "img/characters/tails.png", "img/characters/vector_lg.png", "img/characters/vector.png", "img/characters/waluigi_lg.png", "img/characters/waluigi.png", "img/characters/wario_lg.png", "img/characters/wario.png", "img/characters/yoshi_lg.png", "img/characters/yoshi.png", "img/characters/name_amy.png", "img/characters/name_blaze.png", "img/characters/name_bowser.png", "img/characters/name_bowserjr.png", "img/characters/name_daisy.png", "img/characters/name_donkeykong.png", "img/characters/name_knuckles.png", "img/characters/name_luigi.png", "img/characters/name_mario.png", "img/characters/name_metalsonic.png", "img/characters/name_peach.png", "img/characters/name_shadow.png", "img/characters/name_silver.png", "img/characters/name_sonic.png", "img/characters/name_tails.png", "img/characters/name_vector.png", "img/characters/name_waluigi.png", "img/characters/name_wario.png", "img/characters/name_yoshi.png"];
	
	function preloadImages(imageArray, index) {
		index = index || 0;
		if (imageArray && imageArray.length > index){
			var img = new Image();
			img.onload = function() {
				preloadImages(imageArray, index + 1);
			}
			img.src = images[index];
		}
	}
	preloadImages(images);
	
	var videos = ["videos/vollyball_2d.mp4", "videos/vault_2d.mp4", "videos/shooting_2d.mp4", "videos/marathon_2d.mp4", "videos/longjump_2d.mp4", "videos/kayak_2d.mp4", "videos/judo_2d.mp4", "videos/400m_2d.mp4", "videos/100m_2d.mp4", "videos/10mPlatform_2d.mp4", "videos/triplejump.mp4", "videos/tabletennis.mp4", "videos/discus.mp4", "videos/100m.mp4", "videos/4x100m.mp4", "videos/surfing.mp4", "videos/karate.mp4", "videos/sportclimbing.mp4", "videos/skateboard.mp4", "videos/gymnastics.mp4", "videos/swimming.mp4", "videos/equestrian.mp4", "videos/rowing.mp4", "videos/hurdles.mp4", "videos/football.mp4", "videos/archery.mp4", "videos/badminton.mp4", "videos/boxing.mp4", "videos/javelin.mp4", "videos/rugby.mp4", "videos/fencing.mp4", "videos/dream_karate.mp4", "videos/dream_shooting.mp4", "videos/dream_racing.mp4"];
	
	function preloadVideos(videoArray) {
		jQuery.each(videoArray, function(indexVid){
			var vid = jQuery("<video>", {
				class: 'removeVideo'
			});
			var source = jQuery("<source>", {
				src : videoArray[indexVid],
				type: "video/mp4"
			});
			vid.append(source);
			jQuery(vid).appendTo('body').css('display', 'none');	
		});	
		jQuery('.removeVideo').remove();
	}
	preloadVideos(videos);	
});

//used to make sure that the nav button can't be clicked to quickly
var canClickNav = true;

//controls navigation at smaller screens
function smallNav(){
	"use strict";
	if(jQuery(".hamburger").hasClass("is-active")){
		jQuery('.hamUL').animate({"right": '0%'});
		jQuery('.hamMenuTitle').text("close");
		canClickNav = true;
	}else{
		jQuery('.hamUL').animate({"right": '-100%'});
		canClickNav = true;
	}
}

jQuery(document).ready(function(){

	//scroll
	//When distance from top = 250px fade button in/out	
	$(window).scroll(function(){
		if ($(this).scrollTop() > 250) {
			$('#scrollup').fadeIn(300);
		} else {
			$('#scrollup').fadeOut(300);
		}
	});

	//On click scroll to top of page t = 1000ms
	$('#scrollup').click(function(e){
		e.preventDefault();
		$("html, body").stop(true).animate({ scrollTop: 0 }, 1000);
		return false;
	});

	
	//navigation start	
	"use strict";
	jQuery('.hamburger').click(function(){
		if (canClickNav){
			jQuery(this).toggleClass('is-active');
			canClickNav = false;
			smallNav();
		}
	});
	
	jQuery(".hamUL .container li a").click(function(e){
		e.preventDefault();
		if (jQuery(window).width() <= 768) {
			jQuery("button").removeClass("is-active");
			smallNav();			
		}
		//this makes the screen scroll to right area.
		var hash = this.hash;
		jQuery("html, body").stop().animate({ scrollTop: jQuery(hash).offset().top - 100 }, 1000);	
		return false;
	});
	
	if(jQuery(window).width() <= 768){
		smallNav();
	}else{
		jQuery("button").removeClass("is-active");
		jQuery(".hamUL").css("height","auto");
	}
	
	jQuery(window).resize(function(){
		jQuery("button").removeClass("is-active");
		if(jQuery(window).innerWidth() <= 768){
			jQuery('.hamUL').css("right", '-100%');
			jQuery('.hamburger').css("right", '0');
		}else{
			jQuery(".hamUL").css("display","block");
			jQuery('.hamUL').css("right", '0');
		}
	});	
		
//navigation end	
//hover effect on flags

$('.eflagsGroup').hover(
	function () {
		$('.eflagsDropContent').stop().slideDown();
	}, function () {
		$('.eflagsDropContent').stop().slideUp();
	}
);	

//Click handler for the flags, This is necessary so that you can't choose a non-US country and get into the US bypassing the Age Gate by then choosing the US flag. So on choosing the US Flag, you will change the rating, and remove the ageVerification cookie, then sending them back to the agegate location. Otherwise, it will just add on a tag of ?lang=countrycode to the url and send you to that location. There isn't necessarily a need to add on this tag so you can remove that portion but, it's a good indicator to people that the page has somehow changed.
	
//$('.efigs img').click(function(e){
//	e.preventDefault();
//	var country = $(this).attr('data-country');
//	Cookies.set('lang', country);
//});	

//change efigs button in nav to purchase on scroll or vice versa

function getTopLocation(width) {
	var breakpoint;
	if (width < 400) {
		breakpoint = 400;
	} else if (width < 700) {
		breakpoint = 550;
	}else if (width < 1024) {
		breakpoint = 700;
	} else {
		breakpoint = 1100;
	}
	return breakpoint;
}	
	
jQuery(window).scroll(function(){
	var winWidth = jQuery(window).width();
	var breakpoint = getTopLocation(winWidth);
	jQuery(".eflagsGroup, .navPreOrderButton").removeClass('showInNav');
	if (jQuery("nav").offset().top < breakpoint) {
		jQuery(".eflagsGroup").addClass("showInNav");
	} else {
		jQuery(".navPreOrderButton").addClass("showInNav");
	}
});	
	
//fancybox	
jQuery('[data-fancybox]').fancybox({
	youtube:{
		showinfo:0
	},
		loop: true
});
	
//preoder btn
jQuery('.preorderBtn, .preorderBtnSmall').hover(function(){
	jQuery('.preorderBtn a, .preorderBtnSmall a').css('color', '#ff2824');
}, function(){
	jQuery('.preorderBtn a, .preorderBtnSmall a').css('color', 'white');
});
	
//switch hero image at larger sizes
function showCorrectImages() {
	var winWidth = jQuery(window).width();
	if (winWidth >= 1024 ) {
		jQuery('.heroBG').attr("src", "img/hero/msog_bg_lg.png");
		jQuery('.characterBG').attr("src", "img/characters/characterTop_bg.jpg");
		jQuery('.purchaseBG').attr("src", "img/purchase/purchase_bg.png");
		jQuery('.video').css("background-image", "url(img/video/bg_verylarg.jpg)");
	} else if (winWidth > 768) {
		jQuery('.heroBG').attr("src", "img/hero/msog_bg_lg.png");
		jQuery('.characterBG').attr("src", "img/characters/characterTop_bg.jpg");
		jQuery('.purchaseBG').attr("src", "img/purchase/purchase_bg.png");
		jQuery('.video').css("background-image", "url(img/video/video_bg.jpg)");
//		jQuery('.charactersWithLogo').attr("src", "img/hero/msog_characters_lg.png");
	} else {
		jQuery('.heroBG').attr("src", "img/hero/msog_bg_sm.png");
		jQuery('.characterBG').attr("src", "img/characters/characterTop_bg_sm.jpg");
		jQuery('.purchaseBG').attr("src", "img/purchase/purchase_bg_sm.png");
		jQuery('.video').css("background-image", "url(img/video/video_bg_sm.jpg)");
//		jQuery('.charactersWithLogo').attr("src", "img/hero/msog_characters_sm.png");
	}
}	
	
jQuery(window).resize(function(){
	showCorrectImages();
});
showCorrectImages();
//trailer hover makes play button change opacity
jQuery('.trailer').mouseenter(function(){
	jQuery('.playButton').css('opacity', '.75');
}).mouseleave(function(){
	jQuery('.playButton').css('opacity', '1');
});	
jQuery('.siemaTrailer').mouseenter(function(){
	jQuery(this).find('.siemaPlayButton').css('opacity', '.75');
}).mouseleave(function(){
	jQuery(this).find('.siemaPlayButton').css('opacity', '1');
});	
jQuery('.trailerGroup').mouseenter(function(){
	jQuery(this).find('.trailerPlayButton').css('opacity', '.75');
}).mouseleave(function(){
	jQuery(this).find('.trailerPlayButton').css('opacity', '1');
});	
jQuery('.trailerHeroGroup').mouseenter(function(){
	jQuery(this).find('.heroPlayButton').css('opacity', '.75');
}).mouseleave(function(){
	jQuery(this).find('.heroPlayButton').css('opacity', '1');
});	
//video hover allows the videos to play on hover this is dynamically placing the video src into the source element on hover. and then resetting when moused off. .play() did not work so had to do .load() to note this is used in conjunction with the lazy loading of the videos in the $(window).ready() at top of this page. Cacheing the videos after the page loads.

jQuery('.lgVid, .smVid').mouseenter(function(){
	var vidSRC = jQuery(this).attr('data-src');
	var source = jQuery("<source>", {
		src : vidSRC,
		type: "video/mp4",
		class: 'showVid'
	});
//	jQuery(this).find("video source").attr('src', vidSRC);
	jQuery(this).find("video").append(source);
	jQuery(this).find("img").css('opacity', 0);
	jQuery('video', this).get(0).load();	
}).mouseleave(function(){
	jQuery('video', this).get(0).pause();	
//	jQuery(this).find("video source").attr('src', '');
	jQuery('.showVid').remove();
	jQuery(this).find("img").css('opacity', 1);
});
	

//jQuery('.smVid').mouseenter(function(){
//	var vidSRC = jQuery(this).attr('data-src');
//	jQuery(this).find("video source").attr('src', vidSRC);
//	jQuery(this).find("img").css('opacity', 0);
//	jQuery('video', this).get(0).load();	
//}).mouseleave(function(){
//	jQuery('video', this).get(0).pause();	
//	jQuery(this).find("video source").attr('src', '');
//	jQuery(this).find("img").css('opacity', 1);
//});
	

//trailer carousel using siema carousel	
var trailerCarousel = new Siema({
	perPage: {
		320: 2,
		640: 3
	},
	loop: true,
	duration: 400,
	selector: '.videoSiema'
});	
var $prevVid = jQuery('.videoSelectors .videoPrev');
var $nextVid = jQuery('.videoSelectors .videoNext');
$($prevVid).click(function(){
	var winWidth = jQuery(window).width();
	if (winWidth < 640) {
		trailerCarousel.prev(2);
	} else {
		trailerCarousel.prev(1);
	}	
});	
$($nextVid).click(function(){
	var winWidth = jQuery(window).width();
	if (winWidth < 640) {
		trailerCarousel.next(2);
	} else {
		trailerCarousel.next(1);
	}
});	
jQuery('.videoNext img').hover( 
	function(){ $(this).css('background-color', 'rgba(255, 255, 255, .75)').attr('src', 'img/characters/right_arrow_blue.png') },
	function(){ $(this).css('background-color', 'rgba(255, 255, 255, 1)').attr('src', 'img/characters/right_arrow.png') }
);	
	
jQuery('.videoPrev img').hover( 
	function(){ $(this).css('background-color', 'rgba(255, 255, 255, .75)').attr('src', 'img/characters/left_arrow_blue.png') },
	function(){ $(this).css('background-color', 'rgba(255, 255, 255, 1)').attr('src', 'img/characters/left_arrow.png') }
);	
//character carousel using siema carousel	
var characterCarousel = new Siema({
	perPage: {
		320: 3,
		500: 4,
		640: 5
	},
	loop: true,
	duration: 400,
	selector: '.siema'
});	
var $prev = jQuery('.characterSelectors .prev');
var $next = jQuery('.characterSelectors .next');
$($prev).click(function(){
	var winWidth = jQuery(window).width();
	if (winWidth < 500) {
		characterCarousel.prev(2);
	} else if (winWidth < 640) {
		characterCarousel.prev(3);
	} else {
		characterCarousel.prev(4);
	}
	
});	
$($next).click(function(){
	var winWidth = jQuery(window).width();
	if (winWidth < 500) {
		characterCarousel.next(2);
	} else if (winWidth < 640) {
		characterCarousel.next(3);
	} else {
		characterCarousel.next(4);
	}
});	
function checkCarousel() {
	var winWidth = jQuery(window).width();
	if (winWidth > 768) {
		characterCarousel.destroy();
	} else {
		characterCarousel.init();
	}
}		
jQuery(window).resize(function(){
	checkCarousel();
	changeCharacterSize()
});	
checkCarousel();	

//change character - uses object at top of app.js
function changeCharacterSize() {
	var name = jQuery('.active').attr('data-name');
	var winWidth = jQuery(window).width();
	if (winWidth > 530) {
		jQuery('.characterImage').attr('src', characters[name].charImgLg);
	} else {
		jQuery('.characterImage').attr('src', characters[name].charImg);
	}
}
changeCharacterSize();	
	

jQuery(document).on("click", ".roundedCharNav", function(){
	jQuery('.roundedCharNav').removeClass('active');
	var name = jQuery(this).attr('data-name');
	jQuery('.roundedCharNav[data-name="'+ name +'"]').addClass('active');
//	jQuery(this).addClass('active');	
	jQuery('.characterName').attr('src', characters[name].charName);
	jQuery('.characterName').attr('alt', characters[name].name);	
	jQuery('.characterDescription').text(characters[name].charDesc);	
	var text = name + 'Text';
	var charName = name + "Name"
	jQuery('.characterDescription').attr('id', text);
	jQuery('.characterImage').attr('id', characters[name].name);
	jQuery('.characterName').attr('id', charName);
//	jQuery('.characterImage').attr('src', characters[name].charImg);
	changeCharacterSize();
//	jQuery('.characterInfo').css({opacity: '0'});
//	jQuery('.characterInfo').stop().animate({opacity: '1'}, 800);
	jQuery('.characterDescription, .characterImage, .characterName').css({opacity: '0'});
	jQuery('.characterName').css("right", "-616px");
	jQuery('.characterName').stop().animate({opacity: '1', right: '0px'}, 500, function(){
		jQuery('.characterDescription, .characterImage').stop().animate({opacity: '1'}, 500);
	});
});	

jQuery('.active').click();	

//go to purchase area on click

jQuery('.preorderBtn, .preorderBtnSmall, .navPreOrderButton').click(function(){
	var winWidth = jQuery(window).width();
	jQuery("html, body").animate({ scrollTop: jQuery('#purchase').offset().top }, 1000);
	if (winWidth < 1024){
		jQuery('.purchaseModal').css('display','block');
	}
});	

jQuery('.purchaseBtn').click(function(){
	jQuery('.purchaseModal').css('display','block');
});	
jQuery('.close').click(function() {
	jQuery('.purchaseModal').css('display','none');
});

//function changePurchaseText() {
//	var $winWidth = jQuery(window).width();
//	if ($winWidth < 1024) {
//		jQuery(".purchaseBtnDigital").text('Digital Edition');
//	} else {
//		jQuery(".purchaseBtnDigital").text('Nintendo eShop');
//	}
//}	
//jQuery(window).resize(function(){
//	changePurchaseText();
//});	
//changePurchaseText();	
	
//NEW
	
var $ageSubmit = jQuery('.submitButton');
var $age = jQuery('#age');
	
function cantSignUp() {
	var $message = jQuery("<div>", {
			text: 'Sorry, you can\'t sign-up for our newsletter',
			class: 'errorAge'
		});
		var $text = jQuery("<p>", {			
		});
		var $submitBtn = jQuery("<input>", {
			type: 'submit',
			name: 'backToHome',
			value: 'Back To Home',
			class: 'backToHome'
		});
		$message.append($text).append($submitBtn);
		jQuery('.ageInputArea').html($message);
		jQuery('.errorAge, .errorAge p').css({'opacity': 1, 'font-size': '20px', 'margin-top': '25px'});
		jQuery('.ageForm .newsletterHeader h2').text('');
}	
	
function checkAge(age) {
	if (age < 16) {
		cantSignUp();
		Cookies.set('canSignUp', false, { expires: 7});
	} else {
		jQuery('.signUpForm').css('display', 'block');
		jQuery('.ageForm').css('display', 'none');
	}
}	
	
jQuery($ageSubmit).click(function(){
	var ageData = jQuery('#age').val();
	if (isNaN(ageData) || parseInt(ageData) > 106){
		jQuery('.errorAge').css('opacity', '1');
		jQuery($age).val('');
	} else {
		checkAge(parseInt(ageData));
	}
});	
	
 /*--- Newsletter ---*/
jQuery('.mailIcon').click(function(){
	jQuery('.newsletterBG').addClass('hide');
	var signup = Cookies.get('canSignUp');
	if (signup === "false") {
		cantSignUp();
	}
});	
	
//	NEW END
jQuery(document).on('click', '.fa-times, #close, .closeBtn, .backToHome', function(){
	jQuery('.newsletterBG').removeClass('hide');
});		
		
	
	
	
	
  var $submitButton = $("#mc_embed_signup .button");
  var $acknowledgeCheckbox = $("#acknowledge input");
  var $receiveUpdatesCheckbox = $("#receiveUpdates input");
  var $emailField = $("#mc-embedded-subscribe-form input.email");

  // Is Terms&Conditions chekbox checked?
  function isAcknowledgeChecked() {
	return $acknowledgeCheckbox.is(":checked");
  }

  // Is Sega Products checkbox checked?
  function isUpdatesChecked() {
	return $receiveUpdatesCheckbox.is(":checked");
  }

  // Enable/Disable the submit button if the conditions are met.
  function newsletterUpdateSubmit() {
	var emailText = $('input[type="email"]').val();
	if (emailText !== "") {
		$submitButton
		.prop(
			"disabled",			
		// Negating: because if the conditions are met,
		// disabled is false.
			!(isAcknowledgeChecked() && isUpdatesChecked()));
	} else {
		$submitButton.prop("disabled", true);
	}
  }

  $submitButton.prop("disabled", true);

  $acknowledgeCheckbox.click(function (e) {
	e.stopPropagation();
	newsletterUpdateSubmit();
  });

  $receiveUpdatesCheckbox.click(function (e) {
	e.stopPropagation();
	newsletterUpdateSubmit();
  });

  $emailField.keyup(function () {
	newsletterUpdateSubmit();
  });

//	checks to see if the close button needs to be hidden or not. If on smaller screen, there is no need for it.
//	function checkClose() {
//		var winWidth = jQuery(window).width();
//		if (winWidth < 1024) {
//			jQuery('#close').hide();
//		} else {
//			jQuery('#close').show();
//		}
//	}
	//after submitting the form, this updates what is in the newsletter box and calls the checkClose function
	jQuery('#mc-embedded-subscribe').click(function(){
		//set the slight delay on button change as otherwise the box closes immediately
		setTimeout(function(){
			jQuery('#mc-embedded-subscribe').attr({'value':'close', 'id':'close'});
//			checkClose();
		},200);
		jQuery('.mc-field-group').hide();
		jQuery('.newsletterHeader h2').text('Thank You');
		jQuery('.newsletterHeader h3').html('Your information has been received. <br> To complete the subscription process, please click the link in the email we just sent you.');		
	});	
//	jQuery(window).resize(function(){
//		checkClose();
//	});
  /*--- END Newsletter ---*/	
});








